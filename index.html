<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ads Income Place</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="//libtl.com/sdk.js" data-zone="9777736" data-sdk="show_9777736"></script>

  <style>
    * {margin: 0; padding: 0; box-sizing: border-box;}
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #4f46e5, #9333ea);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px 20px;
      color: #fff;
    }
    .container {
      width: 100%;
      max-width: 420px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    h2 {
      text-align: center;
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 5px;
    }
    p.subtitle {
      text-align: center;
      color: #e0e0ff;
      font-size: 15px;
      margin-bottom: 15px;
    }
    .card {
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      background: rgba(255, 255, 255, 0.15);
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.25);
      transition: transform 0.25s ease;
    }
    .card:hover {transform: translateY(-4px);}
    
    .profile {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }
    .profile img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 3px solid #fff;
    }
    .user-name {
      font-size: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .verify-icon {color: #00bfff; font-size: 18px;}
    .premium-icon {color: gold; font-size: 18px;}
    .info {font-size: 15px; margin-top: 4px;}

    .btn {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      color: #fff;
      background: linear-gradient(90deg, #7c3aed, #4f46e5);
      transition: all 0.3s ease;
    }
    .btn:hover {transform: scale(1.05);}
    .btn:active {transform: scale(0.95);}
    .back-btn {background: linear-gradient(90deg, #374151, #111827);}
    #countdown {
      margin-top: 12px;
      font-size: 14px;
      font-weight: bold;
      color: #ffeb3b;
    }
    input, select {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
      border: none;
      outline: none;
      font-size: 15px;
    }
    .hidden {display: none;}
  </style>
</head>
<body>
  <div class="container">
    <h2>üé• ADS INCOME PLACE</h2>
    <p class="subtitle">Earn 50 coins after ad + claim</p>

    <!-- Profile Card -->
    <div class="card" id="profile">
      <div class="profile">
        <img id="user-photo" src="https://telegram.org/img/t_logo.png" alt="Profile">
        <div class="user-name">
          <span class="verify-icon">‚úîÔ∏è</span>
          <span id="user-name">Loading...</span>
          <span class="premium-icon">‚≠ê</span>
        </div>
        <div class="info"><b>Balance:</b> <span id="balance">0</span> coins</div>
        <div class="info"><b>Ads Watched:</b> <span id="views">0</span></div>
      </div>
    </div>

    <!-- Ad Section -->
    <div class="card" id="ad-section">
      <button class="btn" onclick="watchAd()">üé¨ Watch Ad</button>
      <button class="btn hidden" id="claimBtn" onclick="claimCoins()">üéÅ Claim Coin</button>
      <p id="countdown"></p>
    </div>

    <!-- Withdraw/Referral Main -->
    <div class="card">
      <button class="btn" onclick="showWithdraw()">üí∏ Withdraw</button>
      <button class="btn" onclick="showReferral()">ü§ù Refer</button>
    </div>

    <!-- Withdraw Section -->
    <div class="card hidden" id="withdraw-section">
      <h3>Withdraw Coins</h3>
      <select id="method">
        <option value="bkash">Bkash</option>
        <option value="nagad">Nagad</option>
      </select>
      <input type="number" id="coinAmount" placeholder="Enter Coin Amount" oninput="calculateBDT()">
      <p id="bdtValue">You will get: 0 BDT</p>
      <input type="text" id="accountNumber" placeholder="Enter your account number">
      <button class="btn" onclick="submitWithdraw()">Submit</button>
      <button class="btn back-btn" onclick="goBack()">üîô Back</button>
    </div>

    <!-- Referral Section -->
    <div class="card hidden" id="referral-section">
      <h3>Your Referral Link</h3>
      <p id="refLink">https://t.me/ads25_income_bot?start=ref</p>
      <button class="btn" onclick="copyReferral()">‚òï Copy</button>
      <button class="btn back-btn" onclick="goBack()">üîô Back</button>
    </div>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const userName = tg.initDataUnsafe?.user?.first_name || "Unknown";
    const userId = tg.initDataUnsafe?.user?.id || "Unknown";
    const photoUrl = tg.initDataUnsafe?.user?.photo_url || "https://telegram.org/img/t_logo.png";

    document.getElementById("user-name").innerText = userName;
    document.getElementById("user-photo").src = photoUrl;

    let coins = parseInt(localStorage.getItem("coins")) || 0;
    let views = parseInt(localStorage.getItem("views")) || 0;

    function updateUI() {
      document.getElementById("balance").innerText = coins;
      document.getElementById("views").innerText = views;
    }
    function saveData() {
      localStorage.setItem("coins", coins);
      localStorage.setItem("views", views);
    }

    function watchAd() {
      document.getElementById("claimBtn").classList.add("hidden");
      document.getElementById("countdown").innerText = "‚è≥ Please wait 10 seconds...";

      if (typeof show_9777736 === "function") { show_9777736(); }

      let countdown = 10;
      const interval = setInterval(() => {
        countdown--;
        document.getElementById("countdown").innerText = `‚è≥ Please wait ${countdown} seconds...`;
        if (countdown <= 0) {
          clearInterval(interval);
          document.getElementById("countdown").innerText = "‚úÖ Ad watched. Now claim your coin!";
          document.getElementById("claimBtn").classList.remove("hidden");
        }
      }, 1000);
    }

    function claimCoins() {
      document.getElementById("claimBtn").classList.add("hidden");
      document.getElementById("countdown").innerText = "‚è≥ Showing ad before claim...";

      if (typeof show_9777736 === "function") { show_9777736(); }

      let countdown = 10;
      const interval = setInterval(() => {
        countdown--;
        document.getElementById("countdown").innerText = `‚è≥ Claiming in ${countdown} seconds...`;
        if (countdown <= 0) {
          clearInterval(interval);
          coins += 50;
          views++;
          saveData();
          updateUI();
          document.getElementById("countdown").innerText = "üéâ You earned 50 coins!";
        }
      }, 1000);
    }

    function showWithdraw() {
      document.getElementById("withdraw-section").classList.remove("hidden");
      document.getElementById("ad-section").classList.add("hidden");
      document.getElementById("referral-section").classList.add("hidden");
    }

    function calculateBDT() {
      const amount = parseInt(document.getElementById("coinAmount").value) || 0;
      const bdt = (amount * 0.0038).toFixed(2);
      document.getElementById("bdtValue").innerText = `You will get: ${bdt} BDT`;
    }

    function submitWithdraw() {
      const method = document.getElementById("method").value;
      const amount = parseInt(document.getElementById("coinAmount").value);
      const account = document.getElementById("accountNumber").value.trim();

      if (isNaN(amount) || amount < 100000) {
        alert("Minimum withdraw is 100000 coins.");
        return;
      }
      if (!account || account.length < 6) {
        alert("Please enter a valid account number.");
        return;
      }
      if (amount > coins) {
        alert("You don't have enough coins.");
        return;
      }

      coins -= amount;
      saveData();
      updateUI();

      document.getElementById("withdraw-section").innerHTML = `
        <h3>‚úÖ Withdraw request submitted!</h3>
        <p>Method: ${method.toUpperCase()}</p>
        <p>Amount: ${amount} coins</p>
        <p>Account Number: ${account}</p>
        <p>We will process your request soon.</p>
        <button class="btn back-btn" onclick="goBack()">üîô Back</button>
      `;
    }

    function showReferral() {
      document.getElementById("referral-section").classList.remove("hidden");
      document.getElementById("withdraw-section").classList.add("hidden");
      document.getElementById("ad-section").classList.add("hidden");

      document.getElementById("refLink").innerText =
        `https://t.me/ads25_income_bot?start=${userId}`;
    }

    function copyReferral() {
      const ref = document.getElementById("refLink").innerText;
      navigator.clipboard.writeText(ref);
      alert("Referral link copied!");
    }

    function goBack() {
      document.getElementById("withdraw-section").classList.add("hidden");
      document.getElementById("referral-section").classList.add("hidden");
      document.getElementById("ad-section").classList.remove("hidden");
      updateUI();
    }

    updateUI();
  </script>
</body>
</html>
